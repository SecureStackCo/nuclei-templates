id: aws-object-listing

info:
  name: AWS bucket with Object listing
  author: pdteam
  severity: low
  description: The S3 bucket hosting this web page is incorrectly configured to allow object listing by default. Unless this behaviour is specifically required you should disable public access in both the S3 service and Cloudfront if you are using it. 
  reference:
    - https://mikey96.medium.com/cloud-based-storage-misconfigurations-critical-bounties-361647f78a29
    - https://repost.aws/knowledge-center/s3-returns-objects
  tags: aws,misconfig,bucket,securestack-fast
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}"

    max-size: 1000
    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<ListBucketResult xmlns='

      - type: word
        part: header
        words:
          - application/xml

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - '<Name>([a-z0-9-._]+)'

# Enhanced by 6mile 06/06/2023
