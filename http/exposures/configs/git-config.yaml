id: git-config

info:
  name: Git Configuration Files Exposed in Target
  author: pdteam,pikpikcu,Mah3Sec_,m4lwhere
  severity: high
  description: Git configuration file was detected in the URL path.  This file typically exposed git username and customizations.  Less typically it will include actual git credentials embedded in the file.  In either case its bad practice to expose this file in web apps.
  reference:
    - https://infosecwriteups.com/exposed-git-directory-exploitation-3e30481e8d75
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N
    cvss-score: 5.3
    cwe-id: CWE-200
  tags: config,git,exposure,securestack-fast
  metadata:
    max-request: 1

http:
  - method: GET
    path:
      - "{{BaseURL}}/.git/config"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - "[credentials]"
          - "[core]"
        condition: or

      - type: dsl
        dsl:
          - "!contains(tolower(body), '<html')"
          - "!contains(tolower(body), '<body')"
        condition: and

      - type: status
        status:
          - 200

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "url ?= ?https?://(.*:.*)@"
          - "AUTHORIZATION: basic (.*)"
          - "pass = (.*)"
