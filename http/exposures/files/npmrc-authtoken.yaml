id: npmrc-authtoken

info:
  name: Hardcoded .npmrc AuthToken
  author: geeknik
  severity: high
  description: .npmrc files typically store NPM auth tokens which allow API access to the NPM platform.  Exposing these files can give attackers the ability to list and delete and even publish new packages.  Additionally NPM ignores MFA for automation tokens so MFA will be ignored.
  reference:
    - https://docs.npmjs.com/cli/v8/configuring-npm/npmrc
    - https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-npm-registry
  metadata:
    max-request: 1
    verified: true
    google-query: intitle:"index of" ".npmrc"
  tags: npm,exposure,securestack-fast

http:
  - method: GET
    path:
      - "{{BaseURL}}/.npmrc"

    matchers-condition: and
    matchers:
      - type: word
        words:
          - "_authToken="
          - "_auth="
        condition: or

      - type: word
        part: header
        words:
          - "text/html"
          - "application/javascript"
          - "application/json"
        negative: true

      - type: status
        status:
          - 200
